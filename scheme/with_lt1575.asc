Version 4
SHEET 1 4596 6420
WIRE 944 -528 800 -528
WIRE 1536 -528 1040 -528
WIRE 1568 -528 1536 -528
WIRE 1696 -528 1648 -528
WIRE 1760 -528 1696 -528
WIRE 1616 -448 1536 -448
WIRE 1696 -448 1664 -448
WIRE 1664 -416 1664 -448
WIRE 1664 -416 1552 -416
WIRE 1680 -416 1664 -416
WIRE 1136 -400 1024 -400
WIRE 1616 -400 1616 -448
WIRE 1712 -400 1616 -400
WIRE 1552 -384 1552 -416
WIRE 1712 -384 1712 -400
WIRE 1024 -352 1024 -400
WIRE 1136 -320 1136 -336
WIRE -976 -304 -1040 -304
WIRE -848 -304 -896 -304
WIRE -800 -304 -848 -304
WIRE -688 -304 -720 -304
WIRE -608 -304 -688 -304
WIRE -528 -304 -608 -304
WIRE -464 -304 -528 -304
WIRE -352 -304 -464 -304
WIRE -1536 -272 -1536 -320
WIRE 1040 -256 1040 -288
WIRE 1136 -256 1136 -272
WIRE 1136 -256 1040 -256
WIRE 1392 -256 1312 -256
WIRE 1504 -256 1392 -256
WIRE 1824 -256 1760 -256
WIRE -240 -224 -240 -272
WIRE -848 -208 -848 -240
WIRE -688 -208 -688 -240
WIRE -608 -208 -608 -240
WIRE -528 -208 -528 -240
WIRE -464 -208 -464 -224
WIRE 1008 -208 1008 -288
WIRE -1536 -144 -1536 -192
WIRE -1488 -144 -1536 -144
WIRE 1232 -144 1232 -256
WIRE -1488 -112 -1488 -144
WIRE -1040 -112 -1040 -144
WIRE -240 -112 -240 -144
WIRE 1392 -96 1392 -176
WIRE 1008 -80 1008 -128
WIRE 1632 -80 1632 -128
WIRE -1536 -64 -1536 -144
WIRE -1536 64 -1536 16
WIRE 176 256 160 256
WIRE 512 256 464 256
WIRE 768 256 512 256
WIRE 176 352 160 352
WIRE 512 352 512 256
WIRE 512 352 464 352
WIRE 768 368 768 256
WIRE 176 448 160 448
WIRE 720 448 464 448
WIRE 1424 496 1392 496
WIRE 1744 496 1424 496
WIRE 1824 496 1744 496
WIRE 768 512 768 464
WIRE 784 512 768 512
WIRE 176 544 128 544
WIRE 496 544 464 544
WIRE 544 544 496 544
WIRE 656 544 624 544
WIRE 496 560 496 544
WIRE 656 560 656 544
WIRE 1744 560 1744 496
WIRE 1856 560 1792 560
WIRE 1792 576 1792 560
WIRE 1424 592 1424 560
WIRE 496 640 496 624
WIRE 656 640 656 624
WIRE 1792 640 1792 624
WIRE 1824 640 1792 640
WIRE 1856 640 1824 640
WIRE 1744 656 1744 640
WIRE 1824 672 1824 640
WIRE 128 768 128 544
WIRE 432 768 128 768
WIRE 784 768 784 736
WIRE 784 768 512 768
WIRE 864 768 784 768
WIRE 1056 768 944 768
WIRE 1168 768 1136 768
WIRE 784 784 784 768
WIRE 784 880 784 864
WIRE -528 992 -528 928
WIRE -832 1040 -832 1024
WIRE -864 1056 -928 1056
WIRE -688 1072 -800 1072
WIRE -576 1072 -608 1072
WIRE -864 1088 -912 1088
WIRE -832 1120 -832 1104
WIRE -528 1120 -528 1088
WIRE -528 1264 -528 1200
FLAG 1424 592 0
FLAG 784 880 0
FLAG 656 640 0
FLAG 496 640 0
FLAG 160 256 0
FLAG 160 448 0
FLAG 1824 496 OUT
IOPIN 1824 496 Out
FLAG -1040 -112 0
FLAG -848 -208 0
FLAG -464 -208 0
FLAG -608 -208 0
FLAG -528 -208 0
FLAG -688 -208 0
FLAG -240 -272 VIN
IOPIN -240 -272 In
FLAG -240 -112 0
FLAG 2064 1360 0
FLAG -1744 -848 0
FLAG 1392 -96 0
FLAG 1232 -144 CSENSE
FLAG 800 -528 MOSOUT
IOPIN 800 -528 Out
FLAG 1632 -80 0
FLAG 1824 -256 V+
FLAG -1488 -112 0
FLAG -1536 -320 V+
FLAG -1536 64 V-
FLAG -912 1088 VREF
IOPIN -912 1088 In
FLAG -528 1264 0
FLAG -832 1024 V-
FLAG -832 1120 V+
FLAG -528 928 MOSOUT
IOPIN -528 928 Out
FLAG -1040 1056 OUT
IOPIN -1040 1056 Out
FLAG 128 768 VREF
IOPIN 128 768 In
FLAG 784 512 MOSOUT
IOPIN 784 512 Out
FLAG 784 656 OUT
IOPIN 784 656 Out
FLAG 1760 -528 SHUNT_OUT
IOPIN 1760 -528 Out
FLAG 1392 496 SHUNT_OUT
IOPIN 1392 496 Out
FLAG 992 -320 V-
FLAG 1056 -320 V+
FLAG 1008 -80 0
FLAG 1824 672 0
FLAG 1744 736 0
FLAG 768 256 VIN
IOPIN 768 256 In
FLAG 160 352 V+
FLAG 1168 768 0
SYMBOL nmos 720 368 R0
SYMATTR InstName M1
SYMATTR Value IRFZ24
SYMBOL cap 1408 496 R0
SYMATTR InstName C1
SYMATTR Value 30µ
SYMBOL res 768 640 R0
SYMATTR InstName R1
SYMATTR Value 5000
SYMBOL res 768 768 R0
SYMATTR InstName R2
SYMATTR Value 741.1083889499029
SYMBOL cap 480 560 R0
SYMATTR InstName C2
SYMATTR Value 10p
SYMBOL res 528 560 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 7.5K
SYMBOL cap 640 560 R0
SYMATTR InstName C3
SYMATTR Value 1000p
SYMBOL LT1575 320 400 R0
SYMATTR InstName U1
SYMBOL voltage -1040 -240 R0
WINDOW 3 -38 206 Left 2
WINDOW 123 39 113 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 24 26 Left 2
SYMATTR Value PULSE(0 15 0 0 0 0.000005 0.00001)
SYMATTR InstName V3
SYMBOL ind -992 -288 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=0.11
SYMBOL cap -864 -304 R0
SYMATTR InstName C4
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=0.04
SYMBOL cap -624 -304 R0
WINDOW 0 27 15 Left 2
WINDOW 3 29 51 Left 2
SYMATTR InstName C5
SYMATTR Value 0.1µ
SYMATTR SpiceLine Rser=0.005
SYMBOL res -480 -320 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL cap -544 -304 R0
WINDOW 0 24 15 Left 2
WINDOW 3 24 50 Left 2
SYMATTR InstName C6
SYMATTR Value 1µ
SYMATTR SpiceLine Rser=0.005
SYMBOL ind -816 -288 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 0.1µ
SYMBOL cap -704 -304 R0
SYMATTR InstName C7
SYMATTR Value 0.1µ
SYMATTR SpiceLine Rser=0.021
SYMBOL res -1056 -320 R0
SYMATTR InstName R5
SYMATTR Value 0.01
SYMBOL voltage -240 -240 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value 22
SYMBOL res 1552 -512 R270
WINDOW 0 49 54 VTop 2
WINDOW 3 -7 54 VBottom 2
SYMATTR InstName SHUNT
SYMATTR Value 0.02
SYMBOL res 1376 -272 R0
SYMATTR InstName R7
SYMATTR Value 4.99k
SYMBOL res 1520 -544 R0
SYMATTR InstName R8
SYMATTR Value 100
SYMBOL res 1680 -544 R0
WINDOW 3 36 84 Left 2
SYMATTR Value 100
SYMATTR InstName R9
SYMBOL PowerProducts\\LT6105 1632 -256 M0
WINDOW 0 -2 -62 Center 2
SYMATTR InstName U2
SYMBOL voltage -1536 -288 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 24
SYMBOL voltage -1536 -80 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value 3
SYMBOL Opamps\\LT1363 -832 1136 M180
SYMATTR InstName U4
SYMBOL nmos -576 992 R0
SYMATTR InstName M2
SYMATTR Value IRLML6346
SYMBOL res -544 1104 R0
SYMATTR InstName R13
SYMATTR Value 30
SYMBOL res -592 1056 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 10
SYMBOL nmos 944 -480 R270
SYMATTR InstName M3
SYMATTR Value IRFZ44V
SYMBOL Opamps\\LT1365 1088 -320 M270
WINDOW 0 28 32 Left 2
SYMATTR InstName U5
SYMBOL voltage 1008 -224 M0
WINDOW 123 24 72 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -74 -39 VRight 2
WINDOW 0 55 40 VRight 2
SYMATTR Value PULSE(3.01 0.1 0.0015)
SYMATTR InstName V7
SYMBOL res 1008 -496 R0
SYMATTR InstName R6
SYMATTR Value 10
SYMBOL res 1152 -416 M0
SYMATTR InstName R10
SYMATTR Value 100
SYMBOL cap 1152 -336 M0
SYMATTR InstName C8
SYMATTR Value 10n
SYMBOL res 1328 -272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 3k
SYMBOL voltage 1856 544 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value PULSE(5 5 1.5m 0 0 5m)
SYMBOL res 1728 640 R0
SYMATTR InstName R12
SYMATTR Value 5
SYMBOL sw 1744 656 R180
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL res 960 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 986.3945578
SYMBOL voltage 1040 768 R270
WINDOW 123 24 44 Left 2
WINDOW 39 24 68 Left 2
SYMATTR SpiceLine Rser=0
SYMATTR InstName V1
SYMATTR Value PULSE(0.1 3.0 1m 5m)
SYMBOL res 528 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 0.001
TEXT 1960 968 Left 2 !.tran 6m
TEXT -912 864 Left 2 ;TODO: does not work
TEXT 1568 840 Left 2 !.model MYSW SW(Ron=0.01 Roff=1000k Vt=.00001 Vh=0)
RECTANGLE Normal -32 192 -1232 -464 2
